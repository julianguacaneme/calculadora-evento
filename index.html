<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadora de finanzas Mambo Candela</title>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Montserrat:wght@600;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
    xintegrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"
    xintegrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>

<body>
  <header class="site-header">
    <a href="https://julianguacaneme.com/mambo-candela" target="_blank" rel="noopener">
      <img src="https://julianguacaneme.com/wp-content/uploads/2025/02/Logo-Mambo-Candela-2025-1-e1739552848127.png"
        alt="Logo Mambo Candela" class="logo"
        onerror="this.onerror=null; this.src='https://placehold.co/200x100/C8102E/FFFFFF?text=Mambo+Candela';">
    </a>
  </header>

  <nav class="main-nav">
    <button class="nav-btn active" data-target="section-calculator">Calculadora</button>
    <button class="nav-btn" data-target="section-history">Historial Eventos</button>
    <button class="nav-btn" data-target="section-config">Configuración</button>
  </nav>

  <main id="app-container">
    <!-- SECCIÓN CALCULADORA -->
    <div id="section-calculator" class="view-section active">

      <h1>Calculadora de finanzas</h1>

      <div class="grid">
        <div class="full-width section-title"><strong> INGRESOS Y CAJA </strong></div>
        <div><label for="cajaMenorInicial">Caja Menor Inicial (Base)</label><input type="number" id="cajaMenorInicial"
            value="150000" min="0" step="1000"></div>
        <div><label for="efectivoFinal">Total Efectivo Contado al Final</label><input type="number" id="efectivoFinal"
            value="0" min="0" step="1000"></div>
        <div><label for="daviplata">Ingresos por DAVIPLATA</label><input type="number" id="daviplata" value="0" min="0"
            step="1000"></div>
        <div><label for="nequi">Ingresos por NEQUI</label><input type="number" id="nequi" value="0" min="0" step="1000">
        </div>
        <div><label for="datafono">Ingresos por DATÁFONO (Bruto)</label><input type="number" id="datafono" value="0"
            min="0" step="1000"></div>

        <div class="full-width section-title"><strong> DATOS DE MANILLAS Y COVER </strong></div>
        <div><label for="vendidas">Manillas vendidas</label><input type="number" id="vendidas" value="0" min="0"
            max="500">
        </div>
        <div><label for="precioCover">Precio por entrada/cover</label><input type="number" id="precioCover" value="0"
            min="0" step="1000"></div>

        <div class="full-width section-title"><strong> OTROS DATOS </strong></div>
        <div><label for="musicos">Cantidad de músicos</label><input type="number" id="musicos" value="1" min="1"></div>
        <div>
          <label for="nombreEvento">Nombre del Evento (Opcional)</label>
          <input type="text" id="nombreEvento" placeholder="Ej: Concierto Bar XYZ">
        </div>

        <!-- NOTA: Los parámetros de configuración se han movido a la pestaña Configuración -->
      </div>

      <button id="btnCalcular" class="main-action-button">Calcular y Generar Informe</button>
      <div id="feedbackMessage" class="feedback-message" style="display:none;"></div>

      <div class="results" id="resultados" style="display:none">
        <h2>Resultados del Evento: <span id="nombreEventoResultado"></span></h2>
        <div id="output" class="report-content">
        </div>

        <div class="report-actions">
          <h3 class="section-title">Acciones del Informe</h3>
          <div class="action-buttons-grid">
            <button id="btnEnviarCorreo"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/email.png"
                alt="[Icono de correo]" class="icon" /> Enviar por Correo</button>
            <button id="btnDescargarPDF"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/pdf.png"
                alt="[Icono de PDF]" class="icon" /> Descargar PDF</button>
            <button id="btnImprimir"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/print.png"
                alt="[Icono de imprimir]" class="icon" /> Imprimir Informe</button>
            <button id="btnCompartirWhatsApp"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/whatsapp.png"
                alt="[Icono de WhatsApp]" class="icon" /> Compartir por WhatsApp</button>
            <button id="btnGuardarGoogleSheets" disabled title="Funcionalidad en desarrollo"><img
                src="https://img.icons8.com/ios-glyphs/30/cccccc/google-sheets.png" alt="[Icono de Google Sheets]"
                class="icon" /> Guardar en Google Sheets</button>
            <button id="btnGuardarDB" disabled title="Funcionalidad en desarrollo"><img
                src="https://img.icons8.com/ios-glyphs/30/cccccc/database.png" alt="[Icono de base de datos]"
                class="icon" /> Guardar en Base de Datos</button>
          </div>
        </div>
      </div>

    </div> <!-- Fin seccion calculadora -->

    <!-- SECCIÓN HISTORIAL -->
    <div id="section-history" class="view-section" style="display:none;">
      <h2>Historial de Eventos</h2>
      <div class="table-responsive">
        <table id="eventsTable" class="data-table">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Evento</th>
              <th>Ingresos</th>
              <th>Neto Músicos</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <!-- Se llenará dinámicamente -->
          </tbody>
        </table>
      </div>
      <div id="history-feedback" class="empty-state">No hay eventos guardados.</div>
    </div>

    <!-- SECCIÓN CONFIGURACIÓN -->
    <div id="section-config" class="view-section" style="display:none;">
      <h2>Configuración Global</h2>
      <p class="config-desc">Estos valores se usarán por defecto para todos los nuevos cálculos.</p>

      <div class="grid">
        <div class="full-width section-title"><strong> GASTOS FIJOS </strong></div>
        <div>
          <label for="cfg-costoEnsayo">Costo Sala de Ensayo</label>
          <input type="number" id="cfg-costoEnsayo" class="config-input">
        </div>
        <div>
          <label for="cfg-costoPaqueteManillas">Costo Paquete Manillas (200u)</label>
          <input type="number" id="cfg-costoPaqueteManillas" class="config-input">
        </div>

        <div class="full-width section-title"><strong> PORCENTAJES Y HONORARIOS </strong></div>
        <div>
          <label for="cfg-honorarioRecaudadorPct">Honorarios Recaudador (%)</label>
          <input type="number" id="cfg-honorarioRecaudadorPct" class="config-input" step="0.1">
        </div>
        <div>
          <label for="cfg-reservaBandaPct">Reserva Fondo Banda (%)</label>
          <input type="number" id="cfg-reservaBandaPct" class="config-input" step="0.1">
        </div>
      </div>

      <button id="btnGuardarConfig" class="main-action-button">Guardar Configuración</button>
      <div id="configFeedback" class="feedback-message" style="display:none;"></div>
    </div>

  </main> <!-- Fin app-container -->

  <script src="script.js"></script>
</body>

</html>